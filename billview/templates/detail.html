{% extends "base.html" %}
{% block body %}
<div class="bg-white">
  <div class="mx-auto max-w-7xl px-4 py-24 sm:px-6 lg:px-8">
    <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl mb-8">{{bill.title}}</h2>
    <div class="grid grid-cols-1 items-center gap-x-8 gap-y-16 sm:grid-cols-2">

    <div>
      <dl class="mt-16 grid grid-cols-1 gap-x-6 gap-y-10 sm:grid-cols-2 sm:gap-y-16 lg:gap-x-8">
        <div class="border-t border-gray-200 pt-4">
          <dt class="font-medium text-gray-900">키워드</dt>
          <dd class="mt-2 text-sm text-gray-500"></dd>
        </div>
        <div class="border-t border-gray-200 pt-4">
          <dt class="font-medium text-gray-900">제안 이유 / 주요 내용</dt>
          <dd class="mt-2 text-sm text-gray-500"></dd>
        </div>
        <div class="border-t border-gray-200 pt-4">
          <dt class="font-medium text-gray-900">히스토리</dt>
          <dd class="mt-2 text-sm text-gray-500"></dd>
        </div>
        <div class="border-t border-gray-200 pt-4">
          <dt class="font-medium text-gray-900">표결 결과</dt>
          <dd class="mt-2 text-sm text-gray-700">



  </dd>
</div>
          </dd>
        </div>
        <div class="border-t border-gray-200 pt-4">
          <dt class="font-medium text-gray-900"></dt>
          <dd class="mt-2 text-sm text-gray-500"></dd>
        </div>
      </dl>
    </div>
    <div class="grid grid-cols-2 grid-rows-2 gap-4 sm:gap-6 lg:gap-8">
    </div>
  </div>
</div>

                <!-- 의원 목록 -->
             <!-- <div>
                <h3 class="font-semibold text-gray-900">{{ vote.member.name }}</h3>
                <ul class="space-y-1 text-sm">
                    {% for vote in votes %}
                    <li>
                        <span class="font-medium text-gray-900">{{ vote.member.name }}</span>
                        <span class="text-gray-500">({{ vote.member.party.party }})</span> - 
                        <span class="text-indigo-600">{{ vote.result }}</span>
                    </li>
                    {% endfor %}
                </ul>
             </div> -->

<!-- 히트맵 -->
<div class="col-span-2 row-start-1 bg-white p-4 rounded shadow">
  <h2>히트맵</h2>
  <div id="vote-heatmap"></div>
</div>

{% endblock %}

{% block script %}
<script>
const rawData = {{ heatmap_data|safe }};

const colorMap = {
  '찬성': '#34d399',
  '반대': '#f87171',
  '기권': '#fbbf24',
  '불참': '#d1d5db'
};


// rawData는 2차원 배열 (10행 x 30열)
const dataPoints = [];
for(let row=0; row < rawData.length; row++) {
  for(let col=0; col < rawData[row].length; col++) {
    dataPoints.push({
      x: (col + 1).toString(),  // 열 번호 (문자열)
      y: row + 1,              // 행 번호 (숫자)
      fillColor: colorMap[rawData[row][col]] || '#fff'
    });
  }
}

const series = [{
  name: '투표결과',
  data: dataPoints
}];

var options = {
  chart: {
    type: 'heatmap',
    height: 350
  },
  series: series,
  xaxis: {
    title: { text: '의원 번호 (열)' },
    categories: [...Array(30).keys()].map(i => (i + 1).toString())
  },
  yaxis: {
    title: { text: '행 번호' }
  },
  plotOptions: {
    heatmap: {
      enableShades: false,
      colorScale: {
        ranges: [
          { from: 0, to: 0, color: '#fff' } // 기본 색상 흰색
        ]
      }
    }
  },
  dataLabels: {
    enabled: false
  }
};

var chart = new ApexCharts(document.querySelector("#vote-heatmap"), options);
chart.render();

</script>
{% endblock %}