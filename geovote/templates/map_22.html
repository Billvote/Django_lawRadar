<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>22대 지역구 지도</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    #map {
      width: 800px;
      height: 600px;
      border: 1px solid #ccc;
      margin: 0 auto;
    }
    path {
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2 style="text-align:center;">🗳️ 제22대 지역구 지도</h2>
  <div id="map"></div>

  <script>
    const width = 800, height = 600;

    const svg = d3.select("#map")
      .append("svg")
      .attr("width", width)
      .attr("height", height);

    function partyColor(party) {
      const colors = {
        "더불어민주당": "#1877f2",
        "국민의힘": "#e61e2b",
        "정의당": "#ffcb08",
        "기타": "#999"
      };
      return colors[party] || "#ccc";
    }

    d3.json("/api/districts/").then(data => {
    console.log("features 개수:", data.features.length);

    svg.selectAll("path")
        .data(data.features)
        .enter()
        .append("path")
        .attr("d", path)
        .attr("fill", d => partyColor(d.properties.party))
        .attr("stroke", "#333")
        .attr("stroke-width", 0.5)
        .on("click", (event, d) => {
        const props = d.properties;
        alert(`${props.SIDO_SGG} - ${props.member_name}\n(${props.party})`);
        });
    }).catch(err => {
    console.error("GeoJSON 로딩 실패:", err);
    });

  </script>
</body>
</html>
