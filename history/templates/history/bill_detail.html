{% extends "base.html" %}
{% block body %}
<div class="bg-white min-h-screen">
  <div class="mx-auto max-w-3xl px-4 py-8 sm:px-6 lg:px-8">
    <!-- í—¤ë” ì„¹ì…˜ -->
    <div class="mb-8 border-b pb-6 flex justify-between items-center">
      <div>
        <h1 class="text-3xl font-bold text-gray-900">{{ bill.title }}</h1>
        <div class="mt-2 flex items-center space-x-4 text-sm text-gray-500">
          <span>ì˜ì•ˆë²ˆí˜¸: {{ bill.bill_number }}</span>
          <span>â€¢</span>
          <span>ìƒì„±ì¼: {{ bill.created_at|date:"Y-m-d" }}</span>
        </div>
      </div>
      <div>
        <!-- ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼ (í˜ì´ì§€ ì •ë³´ ìœ ì§€) -->
        <a href="{% url 'history:history_list' %}?page={{ list_page }}" class="inline-block px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition">ëª©ë¡ìœ¼ë¡œ</a>
      </div>
    </div>

    <!-- íƒ€ì„ë¼ì¸ ì„¹ì…˜ -->
    <div class="relative">
      <div class="absolute left-8 top-0 h-full w-0.5 bg-gray-200" aria-hidden="true"></div>
      <h2 class="text-xl font-semibold text-gray-800 mb-8">ğŸ•’ ê´€ë ¨ ì˜ì•ˆ íƒ€ì„ë¼ì¸</h2>
      <div class="space-y-8" id="timeline-list">
        {% for related in related_bills %}
        <div id="timeline-{{ related.pk }}" class="relative pl-16 group">
          <div class="absolute left-8 top-4 -ml-[5px] h-3 w-3 rounded-full bg-indigo-500 shadow-lg"></div>
          <div class="p-6 bg-white border rounded-lg shadow-sm hover:shadow-md transition-shadow 
                     {% if related.id == bill.id %}ring-2 ring-indigo-500{% endif %}">
            <div class="flex justify-between items-start">
              <div>
                <a href="{% url 'history:bill_detail' related.pk %}?page={{ list_page }}" 
                   class="text-base font-medium block {% if related.id == bill.id %}text-indigo-600{% else %}text-gray-900{% endif %}"
                   onclick="scrollToTimeline({{ related.pk }}); return true;">
                  {{ related.summary|default:"(ë‚´ìš© ì—†ìŒ)"|truncatewords:40 }}
                </a>
                <div class="mt-2 flex items-center space-x-4 text-sm text-gray-500">
                  <span>ì˜ì•ˆë²ˆí˜¸: {{ related.bill_number }}</span>
                  <span>â€¢</span>
                  <span>{{ related.created_at|date:"Y-m-d" }}</span>
                </div>
              </div>
              {% if related.id == bill.id %}
              <span class="px-2.5 py-1 text-xs font-medium bg-indigo-100 text-indigo-800 rounded-full">í˜„ì¬ ì˜ì•ˆ</span>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
<script>
// íƒ€ì„ë¼ì¸ í´ë¦­ ì‹œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ìœ ì§€
function scrollToTimeline(pk) {
  setTimeout(function() {
    const el = document.getElementById('timeline-' + pk);
    if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }, 100);
}
// í˜ì´ì§€ ì´ë™ í›„ íƒ€ì„ë¼ì¸ ìë™ ìŠ¤í¬ë¡¤
window.onload = function() {
  const current = document.querySelector('.ring-2');
  if(current) {
    current.scrollIntoView({ behavior: 'auto', block: 'center' });
  }
};
</script>
<style>
  .group:hover .absolute.h-3.w-3 {
    @apply bg-indigo-600;
    transform: scale(1.2);
    transition: all 0.2s ease;
  }
</style>
{% endblock %}
