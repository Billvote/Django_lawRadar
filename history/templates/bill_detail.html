<!-- ê°œì„ ëœ bill_detail.html -->
{% extends "base.html" %}
{% load history_filters %}

{% block body %}  
  <!-- Content -->
  <div class="relative z-10 px-6 py-4 mt-16">
    <div class="max-w-4xl mx-auto">

      <p class="uppercase tracking-wide text-cyan-600 font-semibold mb-2">ğŸ“˜ ì…ë²• ìš”ì•½</p>
      
      <!-- ì˜ì•ˆëª… -->
      <h1 class="text-4xl md:text-6xl font-extrabold text-gray-800 mb-6 leading-tight">
        {{ bill.title }}
      </h1>

      <!-- Meta Information -->
      <div class="flex justify-between items-start my-10">
        {% if bill.related_count %}
        <div class="flex flex-nowrap items-center min-w-[140px] shrink-0 px-3 py-2 backdrop-blur-sm rounded-full text-black border border-gray-100">
            <svg class="w-4 h-4 mr-2 text-cyan-500" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"/>
            </svg>
            ê°œì • {{ bill.related_count }}íšŒ
        </div>
        {% endif %}

          <!-- í‚¤ì›Œë“œ í•´ì‹œíƒœê·¸ -->
          <div class="flex flex-wrap gap-2 justify-end">
            {% with cluster_keywords_dict|get_item:bill.cluster as kw_str %}
              {% if kw_str %}
                {% with kw_list=kw_str|split_by_comma %}
                  {% for kw in kw_list|slice:":5" %}
                    <a href="{% url 'cardnews:card' bill.cluster %}"
                      class="px-3 py-1 bg-gray-100 backdrop-blur-sm text-black rounded-full text-sm font-medium hover:bg-white/20 transition-all duration-300 hover:scale-105">
                      #{{ kw }}
                    </a>
                  {% endfor %}
                {% endwith %}
              {% endif %}
            {% endwith %}
          </div>
        </div>
      </div>
      <div class="border-t border-gray-300 my-6"></div>
    </div>
  </div>
</div>


<!-- Main Content -->
<!-- <div class="bg-gray-50 min-h-screen"> -->
  <div class="max-w-6xl mx-auto px-6">
    <p class="text-lg text-gray-500 mb-4 text-center mb-2">
      âœ”ï¸ ë²•ì•ˆì´ ì–´ë–»ê²Œ ë‹¬ë¼ì¡ŒëŠ”ì§€ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”
    </p>
      <p class="text-base text-gray-400 text-center mb-10">
        ê°œì • ë‚´ìš©ì€ ìµœê·¼ ê°œì •ì•ˆë¶€í„° ì°¨ë¡€ë¡œ ì •ë ¬ë©ë‹ˆë‹¤
      </p>

    <!-- Enhanced Timeline -->
    <div class="relative mb-32">
      <!-- íƒ€ì„ë¼ì¸ ì„  -->
      <div class="absolute left-8 top-0 h-full w-1 bg-gradient-to-b from-emerald-400 via-yellow-300 to-pink-300 transform md:-translate-x-1/2"></div>
      
      <div class="space-y-16">
        {% for related in related_bills %}
        <div class="relative group timeline-item" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:100 }}">
          <!-- Timeline Dot -->
          <div class="absolute left-6  w-6 h-6 bg-white rounded-full transform md:-translate-x-1 shadow-md group-hover:scale-125 transition-all duration-300 z-10
                {% if related.age.number >= 22 %}
                  border-emerald-400
                {% elif related.age.number >= 21 %}
                  border-yellow-400
                {% elif related.age.number >= 20 %}
                  border-pink-400
                {% else %}
                  border-gray-400
                {% endif %}
                border-4
                 ">
            <div class="absolute inset-1 bg-cyan-400 rounded-full group-hover:bg-cyan-400 transition-colors duration-300"></div>
          </div>
          
          <!-- Content -->
          <div class="ml-16 md:ml-16 {% cycle 'md:pr-1/2' 'md:pl-1/2 md:ml-1/2' %}">
            <!-- Date Badge -->
            <div class="inline-flex items-center px-3 py-1 bg-blue-100 text-gray-900 rounded-full text-sm font-semibold mb-4 {% cycle 'md:float-left' 'md:float-left' %}
                        {% if related.age.number >= 22 %}
                          bg-emerald-100
                        {% elif related.age.number >= 21 %}
                          bg-yellow-100
                        {% elif related.age.number >= 20 %}
                          bg-pink-100
                        {% else %}
                          bg-gray-200
                        {% endif %}
                        text-gray-800 md:float-left">
              ğŸ“… {{ related.age.number }}ëŒ€ | {{ related.vote_date|default:"ë‚ ì§œ ì—†ìŒ"|date:"Y-m-d" }}
            </div>
            
            <div class="clear-both"></div>
            
            <!-- ê°œë³„ ì¹´ë“œ -->
          <a href="{{ related.url }}" target="_blank" class="block group">
            <div class="group overflow-hidden rounded border border-gray-200 bg-white/80 shadow-lg hover:shadow-2xl transition-all duration-500 overflow-hidden border border-gray-100 group-hover:border-blue-200 {% cycle 'md:ml-8' 'md:ml-8' %}">
              <!-- ì¹´ë“œ í—¤ë” -->
              <div class="bg-white p-6 border-b border-gray-100">
                <div class="flex items-start justify-between">
                  <div class="flex-1 mt-1 px-3">
                    <h3 class="text-lg font-medium text-gray-900 group-hover:font-bold transition-all duration-300">
                      {{ related.summary|default:"(ë‚´ìš© ì—†ìŒ)" }}
                    </h3>
                  </div>
                </div>
              </div>

              <!-- ì¹´ë“œ í‘¸í„° -->
              <div class="p-6">
                <div class="flex items-center justify-between text-sm text-gray-500">
                  <div class="flex items-center">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20"></svg>
                    <p class="text-gray-600 font-medium">
                      ì˜ì•ˆë²ˆí˜¸ {{ related.bill_number }}
                    </p>
                  </div>
                  <svg class="w-4 h-4 transform group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
                  </svg>
                </div>
              </div>

            </div>
          </a>
            
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<!-- ìœ„ë¡œ ì˜¬ë¼ê°€ê¸° ë²„íŠ¼ -->
<div class="fixed bottom-8 right-8 z-50">
  <button type="button"
          onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
          class="w-14 h-14 text-cyan-500 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 flex items-center justify-center"
          id="scrollTopBtn">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
    </svg>
  </button>
</div>

<style>
/* Custom Variables */
:root {
  --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --neon: {{ cluster_color_map|get_item:bill.cluster|default:'#3b82f6' }};
  --neon-light: {{ cluster_color_map|get_item:bill.cluster|default:'#3b82f6' }}40;
}

/* Smooth Animations */
html {
  scroll-behavior: smooth;
}

/* Custom Animations */
@keyframes float {
  0%, 100% { transform: translateY(0px) rotate(0deg); }
  33% { transform: translateY(-10px) rotate(1deg); }
  66% { transform: translateY(5px) rotate(-1deg); }
}

@keyframes glow {
  0%, 100% { box-shadow: 0 0 20px var(--neon-light); }
  50% { box-shadow: 0 0 40px var(--neon), 0 0 60px var(--neon-light); }
}

.timeline-item:hover .bg-blue-500 {
  animation: glow 2s ease-in-out infinite;
}

/* Glassmorphism Effects */
.backdrop-blur-sm {
  backdrop-filter: blur(8px);
}

/* Enhanced Hover Effects */
.timeline-item:hover {
  transform: translateY(-5px);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
  .timeline-item {
    transform: none !important;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Intersection Observer for Timeline Animation
  const observerOptions = {
    threshold: 0.5,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver(function(entries) {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, observerOptions);

  // Observe timeline items
  document.querySelectorAll('.timeline-item').forEach((item, index) => {
    item.style.opacity = '0';
    item.style.transform = 'translateY(50px)';
    item.style.transition = `opacity 0.3s ease ${index * 0.02}s, transform 0.2s ease ${index * 0.02}s`;
    observer.observe(item);
  });
  
  // Dynamic title sizing
  const title = document.querySelector('h1');
  if (title && title.scrollWidth > title.clientWidth) {
    title.classList.add('text-3xl', 'md:text-4xl');
    title.classList.remove('text-4xl', 'md:text-6xl');
  }
});

</script>
{% endblock %}
